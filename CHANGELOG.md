# Changelog

Все заметные изменения в этом проекте будут задокументированы в этом файле.

Этот формат основывается на [Keep a Changelog](https://keepachangelog.com/en/1.1.0/), и этот проект придерживается [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Предстоящие изменения]

### Изменено

- Данные о токенах теперь хранятся в redis.

## [6.2.0] - 2024-09-04

### Добавлено

- Трейсинг с jaeger

### Изменено

- url register, auth, check_token, verify теперь начинаются с префикса "api/"

## [5.2.0] - 2024-09-03

### Добавлено

- Метрики для prometheus.

### Измененено

- В helm чартах добавлены аннотации для сбора метрик, с помощью prometheus.

## [5.1.0] - 2024-08-29

### Добавлено

- Helm чарты.

## [5.0.0] - 2024-08-27

### Добавлено

- Манифесты для запуска приложения в kubernetes

### Изменено

- При миграции таблицы создаются в схеме lebedev_schema

## [4.0.0] - 2024-08-19

### Добавлено

- Миграции с alembic
- Подключение к тестовой бд во время тестов.
- Инструкция по миграциям в contributing.

### Изменено

- Данные о пользователях теперь хранятся в postgres.
- Обновлены тесты для проверки сохранения данных в бд.
- Модели, которые раньше были реализованы через датаклассы, теперь реализованы с помощью sqlalchemy.

## [3.1.0] - 2024-08-10

### Добавлено

- url /verify/ для отправки в кафку сигнала о необходимости верификации пользователя по фото.

## [3.0.0] - 2024-08-6

### Добавлено

- url /healthz/ready/ для проверки состояния сервиса. Возвращает статус OK(200)

### Изменено

- url /check_token/ теперь принимает id пользователя и проверяет токен, который для него сохранён.

## [2.0.0] - 2024-07-31

### Добавлено

- Docker контейнер
- url /check_token/, который позволяет проверить токен на валидность и в случае успеха возвращает username пользователя, которому принадлежит токен.

### Изменено

- Теперь генерации токена в него добавляется инфомрация о времени устаревания(exp) и времени создания(iat). Токен устаревает через 10 минут.
- /auth/ и /register/ теперь возвращают токен в виде строки а не схемы.
- /register/ теперь возвращает ошибку с кодом 409 в случае если пользователь существует.
- /auth/ теперь возвращает ошибку с кодом 403 в случае если несовпадения логина или пароля.
- /auth/ в случае успеха теперь генерирует и возвращает новый токен если не нашёл существующий или если тот уже устарел. В противном случае возвращает сществующий.

## [1.0.0] - 2024-07-26

### Добавлено

- Api с использованием FastApi
- Интеграционные тесты

### Изменено

- Парли теперь хранятся в захешированном виде

## [0.1.0] - 2024-07-15

### Добавлено

- Класс AuthService, с методами для регистрации и входа пользователя, с использованием логина и пароля.
- Тесты с pytest
- gitlab-ci
